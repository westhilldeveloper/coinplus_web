module.exports=[94355,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d({gallery:a=null,onSuccess:d,onCancel:e}){let f=!!a,[g,h]=(0,c.useState)({title:a?.title||"",description:a?.description||"",images:a?.images||[]}),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)({}),[o,p]=(0,c.useState)(""),q=(0,c.useRef)(null),r=async a=>{let b=Array.from(a.target.files);if(!b.length)return;n(a=>({...a,images:""}));let c=[],d=[];if(b.forEach(a=>{a.type.startsWith("image/")?a.size>5242880?d.push(`${a.name}: Size exceeds 5MB`):c.push(a):d.push(`${a.name}: Not an image file`)}),d.length>0&&n(a=>({...a,images:`Some files were rejected:
${d.join("\n")}`})),0!==c.length){j(!0);try{console.log("Starting upload of",c.length,"images");let a=c.map(async a=>{let b=new FormData;b.append("file",a),b.append("upload_preset","tour_uploads");let c=await fetch("https://api.cloudinary.com/v1_1/ddsim4ixm/image/upload",{method:"POST",body:b});if(!c.ok){let b=await c.text();throw Error(`Failed to upload ${a.name}: ${b}`)}return(await c.json()).secure_url}),b=await Promise.all(a);h(a=>({...a,images:[...a.images,...b]})),p(`âœ“ ${b.length} image(s) uploaded successfully`),setTimeout(()=>p(""),3e3)}catch(a){console.error("Upload failed:",a),n(b=>({...b,images:a.message||"Image upload failed. Please try again."}))}finally{j(!1),q.current&&(q.current.value="")}}},s=async b=>{let c;if(b.preventDefault(),c={},g.title.trim()?g.title.length<3&&(c.title="Title must be at least 3 characters"):c.title="Title is required",g.description.trim()?g.description.length<10&&(c.description="Description must be at least 10 characters"):c.description="Description is required",0===g.images.length&&(c.images="At least one image is required"),n(c),0===Object.keys(c).length){l(!0);try{let b,c=f?`/api/admin/gallery/${a.id}`:"/api/admin/gallery",e=await fetch(c,{method:f?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});try{b=await e.json()}catch(a){throw console.error("JSON parse error:",a),Error("Server returned invalid response. Please try again.")}if(!e.ok)throw Error(b.error||`Failed to ${f?"update":"save"} gallery (Status: ${e.status})`);p(f?"Gallery updated successfully!":"Gallery created successfully!"),f||h({title:"",description:"",images:[]}),d&&setTimeout(()=>{d(b.data)},1e3),setTimeout(()=>{p("")},3e3)}catch(a){console.error("Save failed:",a),n(b=>({...b,form:a.message||`Failed to ${f?"update":"save"} gallery. Please try again.`}))}finally{l(!1)}}},t=a=>{let{name:b,value:c}=a.target;h(a=>({...a,[b]:c})),m[b]&&n(a=>({...a,[b]:""}))};return(0,b.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:f?"Edit Gallery":"Create New Gallery"}),o&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-md",children:o}),m.form&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md",children:m.form}),(0,b.jsxs)("form",{onSubmit:s,className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gallery Title *"}),(0,b.jsx)("input",{type:"text",name:"title",value:g.title,onChange:t,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${m.title?"border-red-500":"border-gray-300"}`,placeholder:"Enter gallery title"}),m.title&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:m.title})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,b.jsx)("textarea",{name:"description",value:g.description,onChange:t,rows:"4",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${m.description?"border-red-500":"border-gray-300"}`,placeholder:"Describe your gallery..."}),m.description&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:m.description}),(0,b.jsxs)("div",{className:"mt-1 text-sm text-gray-500",children:[g.description.length," characters (minimum 10)"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Images * (Multiple allowed)"}),(0,b.jsxs)("div",{className:"space-y-4",children:[g.images.length>0&&(0,b.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,b.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[g.images.length," image(s) uploaded"]}),g.images.length>0&&(0,b.jsx)("button",{type:"button",onClick:()=>h(a=>({...a,images:[]})),className:"text-sm text-red-600 hover:text-red-800",children:"Remove All"})]}),(0,b.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:g.images.map((a,c)=>(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)("div",{className:"aspect-square overflow-hidden rounded-lg border border-gray-200 bg-gray-100",children:(0,b.jsx)("img",{src:a,alt:`Gallery image ${c+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"})}),(0,b.jsx)("button",{type:"button",onClick:()=>{h(a=>({...a,images:a.images.filter((a,b)=>b!==c)}))},className:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200 hover:bg-red-600",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,b.jsxs)("div",{className:"text-xs text-center mt-1 text-gray-500 truncate",children:["Image ",c+1]})]},c))})]}),(0,b.jsxs)("div",{className:`border-2 border-dashed ${m.images?"border-red-300 bg-red-50":"border-gray-300"} rounded-lg p-6 text-center transition-colors duration-200`,children:[(0,b.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,b.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Drag and drop images here, or"}),(0,b.jsxs)("label",{className:"mt-2 inline-block",children:[(0,b.jsx)("span",{className:"sr-only",children:"Choose images"}),(0,b.jsx)("span",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 cursor-pointer font-medium text-sm",children:"Browse Files"}),(0,b.jsx)("input",{ref:q,type:"file",multiple:!0,accept:"image/*",onChange:r,className:"hidden"})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"PNG, JPG, GIF up to 5MB each. You can select multiple files."})]}),i&&(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("div",{className:"w-full max-w-xs mx-auto bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-blue-600 h-2 rounded-full animate-pulse w-1/2"})}),(0,b.jsx)("p",{className:"mt-2 text-sm text-blue-600",children:"Uploading images..."})]})]}),m.images&&(0,b.jsx)("p",{className:"mt-2 text-sm text-red-600 whitespace-pre-line",children:m.images})]})]}),(0,b.jsxs)("div",{className:"pt-4 flex justify-end space-x-3",children:[e&&(0,b.jsx)("button",{type:"button",onClick:()=>{e&&e()},disabled:i||k,className:"px-5 py-2.5 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:i||k,className:`px-5 py-2.5 rounded-md font-medium text-white flex items-center ${i||k?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}`,children:k?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),f?"Updating...":"Creating..."]}):i?"Uploading Images...":f?"Update Gallery":"Create Gallery"})]})]})]})}a.s(["default",()=>d])},32369,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(94355);function f(){let[a,f]=(0,c.useState)(null),[g,h]=(0,c.useState)(!0),[i,j]=(0,c.useState)(""),k=(0,d.useRouter)(),l=(0,d.useParams)();(0,c.useEffect)(()=>{m()},[l.id]);let m=async()=>{try{let a=await fetch(`/api/admin/gallery/${l.id}`),b=await a.json();if(!a.ok)throw Error(b.error||"Failed to fetch gallery");f(b.data)}catch(a){console.error("Fetch error:",a),j(a.message)}finally{h(!1)}},n=()=>{k.push("/admin/media/gallery")};return g?(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,b.jsx)("div",{className:"flex justify-center py-12",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600"})})})}):i?(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"text-red-600 mb-2",children:"Error loading gallery"}),(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-4",children:i}),(0,b.jsx)("button",{onClick:()=>k.push("/admin/media/gallery"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Back to Galleries"})]})})}):a?(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsxs)("button",{onClick:n,className:"flex items-center text-gray-600 hover:text-gray-800",children:[(0,b.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Galleries"]})}),(0,b.jsx)(e.default,{gallery:a,onSuccess:()=>{k.push("/admin/media/gallery")},onCancel:n})]})}):(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"text-gray-600",children:"Gallery not found"}),(0,b.jsx)("button",{onClick:()=>k.push("/admin/media/gallery"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Back to Galleries"})]})})})}a.s(["default",()=>f])}];

//# sourceMappingURL=_fdd748ad._.js.map