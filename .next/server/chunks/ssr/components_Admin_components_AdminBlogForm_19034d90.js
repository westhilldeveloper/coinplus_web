module.exports=[87467,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d({blog:a=null,onSuccess:d,onCancel:e}){let f,g=!!a,[h,i]=(0,c.useState)({title:a?.title||"",description:a?.description||"",imageUrl:a?.imageUrl||""}),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)({}),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(!1),v=(0,c.useRef)(null),w=(0,c.useRef)(null),x=async a=>{let b=a.target.files[0];if(!b)return;if(o(a=>({...a,imageUrl:""})),!b.type.startsWith("image/"))return void o(a=>({...a,imageUrl:"Please select an image file (JPEG, PNG, GIF, etc.)"}));if(b.size>5242880)return void o(a=>({...a,imageUrl:"Image size should be less than 5MB"}));s(URL.createObjectURL(b)),k(!0);let c=new FormData;c.append("file",b),c.append("upload_preset","tour_uploads");try{let a=await fetch("https://api.cloudinary.com/v1_1/ddsim4ixm/image/upload",{method:"POST",body:c});if(!a.ok)throw Error(`Upload failed with status: ${a.status}`);let b=await a.json();if(!b.secure_url)throw Error("No secure URL returned from Cloudinary");i({...h,imageUrl:b.secure_url}),q("âœ“ Image uploaded successfully"),setTimeout(()=>q(""),2e3)}catch(a){console.error("Upload failed:",a),o(b=>({...b,imageUrl:a.message||"Image upload failed. Please try again."})),s(""),i(a=>({...a,imageUrl:""}))}finally{k(!1)}},y=a=>{let b,c;if(!w.current)return;let d=w.current,e=d.selectionStart,f=d.selectionEnd,g=d.value,h=g.substring(e,f);switch(a){case"bold":b=g.substring(0,e)+"**"+h+"**"+g.substring(f),c=f+4;break;case"italic":b=g.substring(0,e)+"*"+h+"*"+g.substring(f),c=f+2;break;case"bullet":if(h.includes("\n")){let a=h.split("\n").map(a=>a.trim()?`â€¢ ${a}`:"").join("\n");b=g.substring(0,e)+a+g.substring(f),c=f+(a.length-h.length)}else b=g.substring(0,e)+"â€¢ "+h+g.substring(f),c=f+2;break;case"number":if(h.includes("\n")){let a=h.split("\n").map((a,b)=>a.trim()?`${b+1}. ${a}`:"").join("\n");b=g.substring(0,e)+a+g.substring(f),c=f+(a.length-h.length)}else b=g.substring(0,e)+"1. "+h+g.substring(f),c=f+3;break;case"link":let j=prompt("Enter URL:");j&&(b=g.substring(0,e)+`[${h||"link"}](${j})`+g.substring(f),c=f+4*!h+j.length+3);return;default:return}i(a=>({...a,description:b})),setTimeout(()=>{w.current&&(w.current.focus(),w.current.setSelectionRange(c,c))},0)},z=async b=>{let c;if(b.preventDefault(),c={},h.title.trim()?h.title.length<3&&(c.title="Title must be at least 3 characters"):c.title="Title is required",h.description.trim()?h.description.length<50&&(c.description="Description must be at least 50 characters"):c.description="Description is required",h.imageUrl||(c.imageUrl="Please upload an image"),o(c),0===Object.keys(c).length){m(!0);try{let b,c=g?`/api/admin/blog/${a.id}`:"/api/admin/blog",e=await fetch(c,{method:g?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)});try{b=await e.json()}catch(a){throw console.error("JSON parse error:",a),Error("Server returned invalid response. Please try again.")}if(!e.ok)throw Error(b.error||`Failed to ${g?"update":"save"} blog (Status: ${e.status})`);q(g?"Blog updated successfully!":"Blog created successfully!"),!g&&(i({title:"",description:"",imageUrl:""}),s(""),v.current&&(v.current.value="")),d&&setTimeout(()=>{d(b.data)},1e3),setTimeout(()=>{q("")},3e3)}catch(a){console.error("Save failed:",a),o(b=>({...b,form:a.message||`Failed to ${g?"update":"save"} blog. Please try again.`}))}finally{m(!1)}}},A=a=>{let{name:b,value:c}=a.target;i(a=>({...a,[b]:c})),n[b]&&o(a=>({...a,[b]:""}))};return(0,b.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:g?"Edit Blog Post":"Create New Blog Post"}),p&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-md",children:p}),n.form&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md",children:n.form}),(0,b.jsxs)("form",{onSubmit:z,className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Blog Title *"}),(0,b.jsx)("input",{type:"text",name:"title",value:h.title,onChange:A,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.title?"border-red-500":"border-gray-300"}`,placeholder:"Enter blog title"}),n.title&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:n.title})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Featured Image *"}),(0,b.jsxs)("div",{className:"space-y-3",children:[r||h.imageUrl?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"w-full max-w-md border-2 border-dashed border-gray-300 rounded-lg overflow-hidden",children:(0,b.jsx)("img",{src:r||h.imageUrl,alt:"Preview",className:"w-full h-64 object-contain"})}),(0,b.jsx)("button",{type:"button",onClick:()=>{i(a=>({...a,imageUrl:""})),s(""),v.current&&(v.current.value=""),o(a=>({...a,imageUrl:""}))},className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full hover:bg-red-600",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}):(0,b.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[(0,b.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,b.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,b.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Upload a featured image"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 5MB"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block",children:[(0,b.jsx)("span",{className:"sr-only",children:"Choose image"}),(0,b.jsx)("input",{ref:v,type:"file",accept:"image/*",onChange:x,className:"block w-full text-sm text-gray-500   file:mr-4 file:py-2 file:px-4   file:rounded-md file:border-0   file:text-sm file:font-semibold   file:bg-blue-50 file:text-blue-700   hover:file:bg-blue-100   cursor-pointer"})]}),j&&(0,b.jsxs)("div",{className:"mt-2",children:[(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,b.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full animate-pulse w-1/2"})}),(0,b.jsx)("p",{className:"mt-1 text-sm text-blue-600",children:"Uploading image..."})]}),n.imageUrl&&(0,b.jsx)("p",{className:"mt-2 text-sm text-red-600",children:n.imageUrl})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Blog Content *"}),(0,b.jsx)("button",{type:"button",onClick:()=>u(!t),className:"text-sm text-blue-600 hover:text-blue-800",children:t?"Show Editor":"Show Preview"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 mb-2 p-2 bg-gray-50 rounded-md border border-gray-200",children:[(0,b.jsx)("button",{type:"button",onClick:()=>y("bold"),className:"px-3 py-1.5 text-sm font-bold bg-white border border-gray-300 rounded hover:bg-gray-50",title:"Bold (Ctrl+B)",children:(0,b.jsx)("strong",{children:"B"})}),(0,b.jsx)("button",{type:"button",onClick:()=>y("italic"),className:"px-3 py-1.5 text-sm italic bg-white border border-gray-300 rounded hover:bg-gray-50",title:"Italic (Ctrl+I)",children:(0,b.jsx)("em",{children:"I"})}),(0,b.jsxs)("button",{type:"button",onClick:()=>y("bullet"),className:"px-3 py-1.5 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50 flex items-center",title:"Bullet List",children:[(0,b.jsx)("span",{className:"mr-1",children:"â€¢"})," List"]}),(0,b.jsx)("button",{type:"button",onClick:()=>y("number"),className:"px-3 py-1.5 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50",title:"Numbered List",children:"1. List"}),(0,b.jsx)("button",{type:"button",onClick:()=>y("link"),className:"px-3 py-1.5 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50",title:"Insert Link",children:"ðŸ”— Link"}),(0,b.jsx)("div",{className:"text-xs text-gray-500 ml-auto flex items-center",children:(0,b.jsx)("span",{children:"Press Enter for new paragraph, Shift+Enter for line break"})})]}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mb-2 p-2 bg-blue-50 rounded",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Bold:"})," **text**"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("em",{children:"Italic:"})," *text*"]}),(0,b.jsx)("div",{children:"Bullet: â€¢ item"}),(0,b.jsx)("div",{children:"Numbered: 1. item"}),(0,b.jsx)("div",{children:"Link: [text](url)"}),(0,b.jsx)("div",{children:"Line break: Press Enter"})]})}),t?(0,b.jsx)("div",{className:`border rounded-md p-4 min-h-[200px] bg-gray-50 ${n.description?"border-red-500":"border-gray-300"}`,children:h.description?(0,b.jsx)("div",{className:"prose prose-lg max-w-none",children:(0,b.jsx)("div",{className:"text-gray-700 whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:(f=h.description.replace(/\n/g,"<br>").replace(/<br><br>/g,"</p><p>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/â€¢\s*(.*?)(?=<br>|$)/g,"<li>$1</li>").replace(/(\d+)\.\s*(.*?)(?=<br>|$)/g,"<li>$2</li>").replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2" class="text-blue-600 hover:underline">$1</a>'),`<p>${f}</p>`)}})}):(0,b.jsx)("p",{className:"text-gray-400 italic",children:"Preview will appear here..."})}):(0,b.jsx)("textarea",{ref:w,name:"description",value:h.description,onChange:A,rows:"15",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm ${n.description?"border-red-500":"border-gray-300"}`,placeholder:"Write your blog content here...      Use **bold** for important text   Use *italic* for emphasis   Use â€¢ for bullet points   Use 1. for numbered lists   Press Enter for new paragraphs      Example:   **Introduction**   This is a sample blog post.      â€¢ First point   â€¢ Second point   â€¢ Third point      1. Step one   2. Step two   3. Step three"}),n.description&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:n.description}),(0,b.jsxs)("div",{className:"mt-1 flex justify-between text-sm",children:[(0,b.jsx)("span",{className:`${h.description.length<50?"text-red-500":"text-gray-500"}`,children:"Minimum 50 characters required"}),(0,b.jsxs)("span",{className:`${h.description.length>=50?"text-green-500":"text-gray-500"}`,children:[h.description.length," characters"]})]})]}),(0,b.jsxs)("div",{className:"pt-4 flex justify-end space-x-3",children:[e&&(0,b.jsx)("button",{type:"button",onClick:e,disabled:j||l,className:"px-5 py-2.5 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:j||l,className:`px-5 py-2.5 rounded-md font-medium text-white flex items-center ${j||l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}`,children:l?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),g?"Updating...":"Publishing..."]}):j?"Uploading Image...":g?"Update Blog Post":"Publish Blog Post"})]})]})]})}a.s(["default",()=>d])}];

//# sourceMappingURL=components_Admin_components_AdminBlogForm_19034d90.js.map