module.exports=[8865,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d(){let[a,d]=(0,c.useState)({description:"",imageUrl:""}),[e,f]=(0,c.useState)(!1),[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)({}),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(""),o=(0,c.useRef)(null),p=async b=>{let c=b.target.files[0];if(!c)return;if(j(a=>({...a,imageUrl:""})),!c.type.startsWith("image/"))return void j(a=>({...a,imageUrl:"Please select an image file (JPEG, PNG, GIF, etc.)"}));if(c.size>5242880)return void j(a=>({...a,imageUrl:"Image size should be less than 5MB"}));n(URL.createObjectURL(c)),f(!0);let e=new FormData;e.append("file",c),e.append("upload_preset","tour_uploads");try{let b=await fetch("https://api.cloudinary.com/v1_1/ddsim4ixm/image/upload",{method:"POST",body:e});if(!b.ok)throw Error(`Upload failed with status: ${b.status}`);let c=await b.json();if(!c.secure_url)throw Error("No secure URL returned from Cloudinary");d({...a,imageUrl:c.secure_url}),l("âœ“ Image uploaded successfully"),setTimeout(()=>l(""),2e3)}catch(a){console.error("Upload failed:",a),j(b=>({...b,imageUrl:a.message||"Image upload failed. Please try again."})),n(""),d(a=>({...a,imageUrl:""}))}finally{f(!1)}},q=async b=>{let c;if(b.preventDefault(),c={},a.description.trim()?a.description.length<10&&(c.description="Description must be at least 10 characters"):c.description="Description is required",a.imageUrl||(c.imageUrl="Please upload an image"),j(c),0===Object.keys(c).length){h(!0);try{let b,c=await fetch("/api/admin/news",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});try{b=await c.json()}catch(a){throw console.error("JSON parse error:",a),Error("Server returned invalid response. Please try again.")}if(!c.ok)throw Error(b.error||`Failed to save news (Status: ${c.status})`);l("News saved successfully!"),d({description:"",imageUrl:""}),n(""),o.current&&(o.current.value=""),setTimeout(()=>{l("")},3e3)}catch(a){console.error("Save failed:",a),j(b=>({...b,form:a.message||"Failed to save news. Please try again."}))}finally{h(!1)}}};return(0,b.jsxs)("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Add News"}),k&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-md",children:k}),i.form&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md",children:i.form}),(0,b.jsxs)("form",{onSubmit:q,className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image *"}),(0,b.jsxs)("div",{className:"space-y-3",children:[m||a.imageUrl?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"w-full max-w-md border-2 border-dashed border-gray-300 rounded-lg overflow-hidden",children:(0,b.jsx)("img",{src:m||a.imageUrl,alt:"Preview",className:"w-full h-64 object-contain"})}),(0,b.jsx)("button",{type:"button",onClick:()=>{d(a=>({...a,imageUrl:""})),n(""),o.current&&(o.current.value=""),j(a=>({...a,imageUrl:""}))},className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full hover:bg-red-600",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}):(0,b.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[(0,b.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,b.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,b.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Upload an image"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 5MB"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block",children:[(0,b.jsx)("span",{className:"sr-only",children:"Choose image"}),(0,b.jsx)("input",{ref:o,type:"file",accept:"image/*",onChange:p,className:"block w-full text-sm text-gray-500   file:mr-4 file:py-2 file:px-4   file:rounded-md file:border-0   file:text-sm file:font-semibold   file:bg-blue-50 file:text-blue-700   hover:file:bg-blue-100   cursor-pointer"})]}),e&&(0,b.jsxs)("div",{className:"mt-2",children:[(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,b.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full animate-pulse w-1/2"})}),(0,b.jsx)("p",{className:"mt-1 text-sm text-blue-600",children:"Uploading image..."})]}),i.imageUrl&&(0,b.jsx)("p",{className:"mt-2 text-sm text-red-600",children:i.imageUrl})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,b.jsx)("textarea",{name:"description",value:a.description,onChange:a=>{let{name:b,value:c}=a.target;d(a=>({...a,[b]:c})),i[b]&&j(a=>({...a,[b]:""}))},rows:"6",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.description?"border-red-500":"border-gray-300"}`,placeholder:"Write your news description here..."}),i.description&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:i.description}),(0,b.jsxs)("div",{className:"mt-1 flex justify-between text-sm",children:[(0,b.jsx)("span",{className:`${a.description.length<10?"text-red-500":"text-gray-500"}`,children:"Minimum 10 characters required"}),(0,b.jsxs)("span",{className:`${a.description.length>=10?"text-green-500":"text-gray-500"}`,children:[a.description.length,"/10"]})]})]}),(0,b.jsx)("div",{className:"pt-4",children:(0,b.jsx)("button",{type:"submit",disabled:e||g,className:`w-full py-3 px-4 rounded-md font-medium text-white flex items-center justify-center ${e||g?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}`,children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):e?"Uploading Image...":"Save News"})})]})]})}a.s(["default",()=>d])}];

//# sourceMappingURL=components_Admin_components_AdminNewsForm_aceb8415.js.map