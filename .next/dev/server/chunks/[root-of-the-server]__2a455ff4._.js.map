{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/coinplusweb/app/api/chits/%5Bid%5D/route.js"],"sourcesContent":["// app/api/chits/[id]/route.js\r\nimport prisma from '@/app/lib/prisma'\r\nimport { NextResponse } from 'next/server'\r\n\r\nexport async function GET(request, { params }) {\r\n  try {\r\n    // Await the params to get the actual value\r\n    const { id } = await params\r\n    const parsedId = parseInt(id)\r\n\r\n    if (isNaN(parsedId)) {\r\n      return NextResponse.json(\r\n        { success: false, error: 'Invalid ID format' },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    const chit = await prisma.chit.findUnique({\r\n      where: { id: parsedId }\r\n    })\r\n\r\n    if (!chit) {\r\n      return NextResponse.json(\r\n        { success: false, error: 'Chit not found' },\r\n        { status: 404 }\r\n      )\r\n    }\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      data: chit\r\n    })\r\n\r\n  } catch (error) {\r\n    console.error('Get chit error:', error)\r\n    return NextResponse.json(\r\n      { success: false, error: error.message },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n\r\nexport async function PUT(request, { params }) {\r\n  try {\r\n    // Await the params to get the actual value\r\n    const { id } = await params\r\n    const parsedId = parseInt(id)\r\n\r\n    if (isNaN(parsedId)) {\r\n      return NextResponse.json(\r\n        { success: false, error: 'Invalid ID format' },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    const body = await request.json()\r\n\r\n    // Check if chit exists\r\n    const existingChit = await prisma.chit.findUnique({\r\n      where: { id: parsedId }\r\n    })\r\n\r\n    if (!existingChit) {\r\n      return NextResponse.json(\r\n        { success: false, error: 'Chit not found' },\r\n        { status: 404 }\r\n      )\r\n    }\r\n\r\n    // Helper function to handle undefined/null values\r\n    const parseFloatOrNull = (value) => {\r\n      if (value === null || value === undefined || value === '') {\r\n        return null\r\n      }\r\n      const parsed = parseFloat(value)\r\n      return isNaN(parsed) ? null : parsed\r\n    }\r\n\r\n    const parseIntOrNull = (value) => {\r\n      if (value === null || value === undefined || value === '') {\r\n        return null\r\n      }\r\n      const parsed = parseInt(value)\r\n      return isNaN(parsed) ? null : parsed\r\n    }\r\n\r\n    // Update chit with proper handling\r\n    const updatedChit = await prisma.chit.update({\r\n      where: { id: parsedId },\r\n      data: {\r\n        chit_value: body.chit_value !== undefined ? parseFloat(body.chit_value) : existingChit.chit_value,\r\n        location: body.location || existingChit.location,\r\n        state: body.state || existingChit.state,\r\n        branch: body.branch || existingChit.branch,\r\n        phone_number_1: body.phone_number_1 !== undefined ? body.phone_number_1 : existingChit.phone_number_1,\r\n        phone_number_2: body.phone_number_2 !== undefined ? body.phone_number_2 : existingChit.phone_number_2,\r\n        monthly_contribution: parseFloatOrNull(body.monthly_contribution),\r\n        chit_group: body.chit_group !== undefined ? body.chit_group : existingChit.chit_group,\r\n        duration_months: parseIntOrNull(body.duration_months)\r\n      }\r\n    })\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      message: 'Chit updated successfully',\r\n      data: updatedChit\r\n    })\r\n\r\n  } catch (error) {\r\n    console.error('Update chit error:', error)\r\n    return NextResponse.json(\r\n      { \r\n        success: false, \r\n        error: error.message || 'Failed to update chit'\r\n      },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n\r\nexport async function DELETE(request, { params }) {\r\n  try {\r\n    // Await the params to get the actual value\r\n    const { id } = await params\r\n    const parsedId = parseInt(id)\r\n\r\n    if (isNaN(parsedId)) {\r\n      return NextResponse.json(\r\n        { success: false, error: 'Invalid ID format' },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    // Check if chit exists\r\n    const existingChit = await prisma.chit.findUnique({\r\n      where: { id: parsedId }\r\n    })\r\n\r\n    if (!existingChit) {\r\n      return NextResponse.json(\r\n        { success: false, error: 'Chit not found' },\r\n        { status: 404 }\r\n      )\r\n    }\r\n\r\n    // Delete chit\r\n    await prisma.chit.delete({\r\n      where: { id: parsedId }\r\n    })\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      message: 'Chit deleted successfully'\r\n    })\r\n\r\n  } catch (error) {\r\n    console.error('Delete chit error:', error)\r\n    return NextResponse.json(\r\n      { success: false, error: error.message },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}"],"names":[],"mappings":"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"}}]
}