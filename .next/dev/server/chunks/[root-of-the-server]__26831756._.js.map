{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/coinplusweb/app/lib/auth.js"],"sourcesContent":["// app/lib/auth.js (Server-side)\r\nimport { cookies } from 'next/headers'\r\n\r\nexport async function loginUser(username, password) {\r\n  // Get credentials from environment variables\r\n  const ADMIN_USERNAME = process.env.ADMIN_USERNAME\r\n  const ADMIN_PASSWORD = process.env.ADMIN_PASSWORD\r\n  const ADMIN_NAME = process.env.ADMIN_NAME || 'Admin User'\r\n  const ADMIN_EMAIL = process.env.ADMIN_EMAIL || 'admin@coinplus.com'\r\n  const SESSION_DAYS = parseInt(process.env.ADMIN_SESSION_DAYS) || 7\r\n\r\n  // Validate that environment variables are set\r\n  if (!ADMIN_USERNAME || !ADMIN_PASSWORD) {\r\n    console.error('Admin credentials are not configured in environment variables')\r\n    return { success: false, error: 'Server configuration error' }\r\n  }\r\n\r\n  if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {\r\n    const userData = {\r\n      username: ADMIN_USERNAME,\r\n      name: ADMIN_NAME,\r\n      email: ADMIN_EMAIL,\r\n      role: 'admin'\r\n    }\r\n    \r\n    const cookieStore = await cookies()\r\n    cookieStore.set('admin_user', JSON.stringify(userData), {\r\n      httpOnly: true,\r\n      secure: process.env.NODE_ENV === 'production',\r\n      sameSite: 'strict',\r\n      maxAge: 60 * 60 * 24 * SESSION_DAYS, // Configurable days\r\n      path: '/',\r\n    })\r\n    \r\n    return { success: true, user: userData }\r\n  }\r\n  \r\n  return { success: false, error: 'Invalid credentials' }\r\n}\r\n\r\nexport async function logoutUser() {\r\n  const cookieStore = await cookies()\r\n  cookieStore.delete('admin_user')\r\n  return { success: true }\r\n}\r\n\r\nexport async function getCurrentUser() {\r\n  const cookieStore = await cookies()\r\n  const userCookie = cookieStore.get('admin_user')\r\n  \r\n  if (!userCookie?.value) return null\r\n  \r\n  try {\r\n    return JSON.parse(userCookie.value)\r\n  } catch {\r\n    return null\r\n  }\r\n}\r\n\r\n// Optional: Add a function to verify admin access for API routes\r\nexport async function verifyAdmin() {\r\n  const user = await getCurrentUser()\r\n  \r\n  if (!user) {\r\n    return { isAuthenticated: false, error: 'Not authenticated' }\r\n  }\r\n  \r\n  if (user.role !== 'admin') {\r\n    return { isAuthenticated: false, error: 'Not authorized' }\r\n  }\r\n  \r\n  return { isAuthenticated: true, user }\r\n}"],"names":[],"mappings":"AAAA,gCAAgC;;;;;;;;;;;AAChC;;AAEO,eAAe,UAAU,QAAQ,EAAE,QAAQ;IAChD,6CAA6C;IAC7C,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc;IACjD,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc;IACjD,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;IAC7C,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;IAC/C,MAAM,eAAe,SAAS,QAAQ,GAAG,CAAC,kBAAkB,KAAK;IAEjE,8CAA8C;IAC9C,IAAI,CAAC,kBAAkB,CAAC,gBAAgB;QACtC,QAAQ,KAAK,CAAC;QACd,OAAO;YAAE,SAAS;YAAO,OAAO;QAA6B;IAC/D;IAEA,IAAI,aAAa,kBAAkB,aAAa,gBAAgB;QAC9D,MAAM,WAAW;YACf,UAAU;YACV,MAAM;YACN,OAAO;YACP,MAAM;QACR;QAEA,MAAM,cAAc,MAAM,IAAA,4IAAO;QACjC,YAAY,GAAG,CAAC,cAAc,KAAK,SAAS,CAAC,WAAW;YACtD,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK,KAAK;YACvB,MAAM;QACR;QAEA,OAAO;YAAE,SAAS;YAAM,MAAM;QAAS;IACzC;IAEA,OAAO;QAAE,SAAS;QAAO,OAAO;IAAsB;AACxD;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,MAAM,CAAC;IACnB,OAAO;QAAE,SAAS;IAAK;AACzB;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,aAAa,YAAY,GAAG,CAAC;IAEnC,IAAI,CAAC,YAAY,OAAO,OAAO;IAE/B,IAAI;QACF,OAAO,KAAK,KAAK,CAAC,WAAW,KAAK;IACpC,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAGO,eAAe;IACpB,MAAM,OAAO,MAAM;IAEnB,IAAI,CAAC,MAAM;QACT,OAAO;YAAE,iBAAiB;YAAO,OAAO;QAAoB;IAC9D;IAEA,IAAI,KAAK,IAAI,KAAK,SAAS;QACzB,OAAO;YAAE,iBAAiB;YAAO,OAAO;QAAiB;IAC3D;IAEA,OAAO;QAAE,iBAAiB;QAAM;IAAK;AACvC"}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/coinplusweb/app/api/auth/login/route.js"],"sourcesContent":["// app/api/auth/login/route.js\r\nimport { loginUser } from '../../../lib/auth'\r\n\r\nexport async function POST(request) {\r\n  try {\r\n    const { username, password } = await request.json()\r\n    const result = await loginUser(username, password)\r\n    return Response.json(result)\r\n  } catch (error) {\r\n    return Response.json({ success: false, error: 'Login failed' }, { status: 500 })\r\n  }\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"AAAA,8BAA8B;;;;;AAC9B;;AAEO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QACjD,MAAM,SAAS,MAAM,IAAA,iIAAS,EAAC,UAAU;QACzC,OAAO,SAAS,IAAI,CAAC;IACvB,EAAE,OAAO,OAAO;QACd,OAAO,SAAS,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IAChF;AACF"}}]
}