{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/coinplusweb/app/lib/prisma.js"],"sourcesContent":["// app/lib/prisma.js\r\nimport { PrismaClient } from '@prisma/client'\r\n\r\nconst globalForPrisma = globalThis\r\n\r\nconst prisma =\r\n  globalForPrisma.prisma ??\r\n  new PrismaClient({\r\n    log: ['error', 'warn'],\r\n  })\r\n\r\nif (process.env.NODE_ENV !== 'production') {\r\n  globalForPrisma.prisma = prisma\r\n}\r\n\r\nexport default prisma\r\n"],"names":[],"mappings":"AAAA,oBAAoB;;;;;AACpB;;AAEA,MAAM,kBAAkB;AAExB,MAAM,SACJ,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;QAAS;KAAO;AACxB;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B;uCAEe"}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/coinplusweb/app/api/admin/branches/%5Bid%5D/route.js"],"sourcesContent":["// app/api/admin/branches/[id]/route.js\r\nimport { NextResponse } from 'next/server';\r\nimport prisma from '@/app/lib/prisma'\r\n\r\n// Helper function to parse ID safely\r\nfunction parseId(id) {\r\n  console.log('üìù Parsing ID:', id, 'Type:', typeof id);\r\n  const parsed = parseInt(id);\r\n  if (isNaN(parsed)) {\r\n    throw new Error(`Invalid ID format: ${id}`);\r\n  }\r\n  return parsed;\r\n}\r\n\r\n// GET single branch\r\nexport async function GET(request, { params }) {\r\n  try {\r\n    // IMPORTANT: Await the params promise\r\n    const { id: paramId } = await params;\r\n    console.log('üîÑ GET /api/admin/branches/[id] called with ID:', paramId);\r\n    \r\n    if (!paramId) {\r\n      return NextResponse.json(\r\n        { error: 'Branch ID is required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n    \r\n    const id = parseId(paramId);\r\n    console.log('‚úÖ Parsed ID:', id);\r\n    \r\n    const branch = await prisma.branch.findUnique({\r\n      where: { id: id }\r\n    });\r\n    \r\n    if (!branch) {\r\n      return NextResponse.json(\r\n        { error: `Branch with ID ${id} not found` },\r\n        { status: 404 }\r\n      );\r\n    }\r\n    \r\n    return NextResponse.json(branch);\r\n  } catch (error) {\r\n    console.error('‚ùå Error in GET [id]:', error);\r\n    return NextResponse.json(\r\n      { \r\n        error: error.message.includes('Invalid ID') ? error.message : 'Failed to fetch branch',\r\n        details: process.env.NODE_ENV === 'development' ? error.message : undefined\r\n      },\r\n      { status: error.message.includes('Invalid ID') ? 400 : 500 }\r\n    );\r\n  }\r\n}\r\n\r\n// PUT update branch\r\nexport async function PUT(request, { params }) {\r\n  try {\r\n    // IMPORTANT: Await the params promise\r\n    const { id: paramId } = await params;\r\n    console.log('üîÑ PUT /api/admin/branches/[id] called with ID:', paramId);\r\n    \r\n    if (!paramId) {\r\n      return NextResponse.json(\r\n        { error: 'Branch ID is required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n    \r\n    const id = parseId(paramId);\r\n    console.log('‚úÖ Parsed ID for update:', id);\r\n    \r\n    const body = await request.json();\r\n    console.log('üì• Update body:', body);\r\n    \r\n    // Check if branch exists first\r\n    const existingBranch = await prisma.branch.findUnique({\r\n      where: { id: id }\r\n    });\r\n    \r\n    if (!existingBranch) {\r\n      return NextResponse.json(\r\n        { error: `Branch with ID ${id} not found` },\r\n        { status: 404 }\r\n      );\r\n    }\r\n    \r\n    // Prepare update data\r\n    const updateData = {};\r\n    \r\n    // Only include fields that are provided\r\n    if (body.name !== undefined) updateData.name = body.name;\r\n    if (body.address !== undefined) updateData.address = body.address;\r\n    if (body.city !== undefined) updateData.city = body.city;\r\n    if (body.state !== undefined) updateData.state = body.state;\r\n    if (body.pincode !== undefined) updateData.pincode = body.pincode;\r\n    if (body.email !== undefined) updateData.email = body.email;\r\n    if (body.phone1 !== undefined) updateData.phone1 = body.phone1;\r\n    if (body.phone2 !== undefined) updateData.phone2 = body.phone2 || null;\r\n    \r\n    // Handle numeric fields\r\n    if (body.latitude !== undefined) {\r\n      updateData.latitude = body.latitude ? parseFloat(body.latitude) : null;\r\n    }\r\n    if (body.longitude !== undefined) {\r\n      updateData.longitude = body.longitude ? parseFloat(body.longitude) : null;\r\n    }\r\n    \r\n    console.log('üìù Update data for ID', id, ':', updateData);\r\n    \r\n    const branch = await prisma.branch.update({\r\n      where: { id: id },\r\n      data: updateData\r\n    });\r\n    \r\n    console.log('‚úÖ Updated branch ID:', branch.id);\r\n    \r\n    return NextResponse.json(branch);\r\n  } catch (error) {\r\n    console.error('‚ùå Error in PUT [id]:', error);\r\n    console.error('Error code:', error.code);\r\n    console.error('Error name:', error.name);\r\n    \r\n    // Handle Prisma specific errors\r\n    if (error.code === 'P2025') {\r\n      return NextResponse.json(\r\n        { error: `Branch not found` },\r\n        { status: 404 }\r\n      );\r\n    }\r\n    \r\n    if (error.code === 'P1017') {\r\n      return NextResponse.json(\r\n        { error: 'Database connection error' },\r\n        { status: 503 }\r\n      );\r\n    }\r\n    \r\n    return NextResponse.json(\r\n      { \r\n        error: 'Failed to update branch',\r\n        details: process.env.NODE_ENV === 'development' ? error.message : undefined\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n// DELETE branch\r\nexport async function DELETE(request, { params }) {\r\n  try {\r\n    // IMPORTANT: Await the params promise\r\n    const { id: paramId } = await params;\r\n    console.log('üîÑ DELETE /api/admin/branches/[id] called with ID:', paramId);\r\n    \r\n    if (!paramId) {\r\n      return NextResponse.json(\r\n        { error: 'Branch ID is required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n    \r\n    const id = parseId(paramId);\r\n    console.log('‚úÖ Parsed ID for delete:', id);\r\n    \r\n    // Check if branch exists first\r\n    const existingBranch = await prisma.branch.findUnique({\r\n      where: { id: id }\r\n    });\r\n    \r\n    if (!existingBranch) {\r\n      return NextResponse.json(\r\n        { error: `Branch with ID ${id} not found` },\r\n        { status: 404 }\r\n      );\r\n    }\r\n    \r\n    await prisma.branch.delete({\r\n      where: { id: id }\r\n    });\r\n    \r\n    console.log('‚úÖ Deleted branch ID:', id);\r\n    \r\n    return NextResponse.json({ \r\n      success: true,\r\n      message: `Branch with ID ${id} deleted successfully`,\r\n      deletedId: id\r\n    });\r\n  } catch (error) {\r\n    console.error('‚ùå Error in DELETE [id]:', error);\r\n    console.error('Error code:', error.code);\r\n    console.error('Error name:', error.name);\r\n    \r\n    // Handle Prisma specific errors\r\n    if (error.code === 'P2025') {\r\n      return NextResponse.json(\r\n        { error: `Branch not found` },\r\n        { status: 404 }\r\n      );\r\n    }\r\n    \r\n    if (error.code === 'P1017') {\r\n      return NextResponse.json(\r\n        { error: 'Database connection closed. Please try again.' },\r\n        { status: 503 }\r\n      );\r\n    }\r\n    \r\n    return NextResponse.json(\r\n      { \r\n        error: 'Failed to delete branch',\r\n        details: process.env.NODE_ENV === 'development' ? error.message : undefined\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n// Optional: Handle HEAD and OPTIONS methods\r\nexport async function HEAD(request, { params }) {\r\n  try {\r\n    const { id: paramId } = await params;\r\n    const id = parseId(paramId);\r\n    \r\n    const exists = await prisma.branch.findUnique({\r\n      where: { id: id },\r\n      select: { id: true }\r\n    });\r\n    \r\n    return new NextResponse(null, {\r\n      status: exists ? 200 : 404,\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      }\r\n    });\r\n  } catch (error) {\r\n    return new NextResponse(null, { status: 400 });\r\n  }\r\n}\r\n\r\nexport async function OPTIONS() {\r\n  return new NextResponse(null, {\r\n    status: 200,\r\n    headers: {\r\n      'Allow': 'GET, PUT, DELETE, HEAD, OPTIONS',\r\n      'Access-Control-Allow-Methods': 'GET, PUT, DELETE, HEAD, OPTIONS',\r\n      'Access-Control-Allow-Headers': 'Content-Type, Authorization',\r\n    }\r\n  });\r\n}"],"names":[],"mappings":"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"}}]
}