(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67050,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function s({blog:e=null,onSuccess:s,onCancel:l}){let i,a=!!e,[n,o]=(0,r.useState)({title:e?.title||"",description:e?.description||"",imageUrl:e?.imageUrl||""}),[d,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(!1),[g,b]=(0,r.useState)({}),[p,x]=(0,r.useState)(""),[h,f]=(0,r.useState)(""),[y,j]=(0,r.useState)(!1),v=(0,r.useRef)(null),N=(0,r.useRef)(null),w=async e=>{let t=e.target.files[0];if(!t)return;if(b(e=>({...e,imageUrl:""})),!t.type.startsWith("image/"))return void b(e=>({...e,imageUrl:"Please select an image file (JPEG, PNG, GIF, etc.)"}));if(t.size>5242880)return void b(e=>({...e,imageUrl:"Image size should be less than 5MB"}));f(URL.createObjectURL(t)),c(!0);let r=new FormData;r.append("file",t),r.append("upload_preset","tour_uploads");try{let e=await fetch("https://api.cloudinary.com/v1_1/ddsim4ixm/image/upload",{method:"POST",body:r});if(!e.ok)throw Error(`Upload failed with status: ${e.status}`);let t=await e.json();if(!t.secure_url)throw Error("No secure URL returned from Cloudinary");o({...n,imageUrl:t.secure_url}),x("âœ“ Image uploaded successfully"),setTimeout(()=>x(""),2e3)}catch(e){console.error("Upload failed:",e),b(t=>({...t,imageUrl:e.message||"Image upload failed. Please try again."})),f(""),o(e=>({...e,imageUrl:""}))}finally{c(!1)}},k=e=>{let t,r;if(!N.current)return;let s=N.current,l=s.selectionStart,i=s.selectionEnd,a=s.value,n=a.substring(l,i);switch(e){case"bold":t=a.substring(0,l)+"**"+n+"**"+a.substring(i),r=i+4;break;case"italic":t=a.substring(0,l)+"*"+n+"*"+a.substring(i),r=i+2;break;case"bullet":if(n.includes("\n")){let e=n.split("\n").map(e=>e.trim()?`â€¢ ${e}`:"").join("\n");t=a.substring(0,l)+e+a.substring(i),r=i+(e.length-n.length)}else t=a.substring(0,l)+"â€¢ "+n+a.substring(i),r=i+2;break;case"number":if(n.includes("\n")){let e=n.split("\n").map((e,t)=>e.trim()?`${t+1}. ${e}`:"").join("\n");t=a.substring(0,l)+e+a.substring(i),r=i+(e.length-n.length)}else t=a.substring(0,l)+"1. "+n+a.substring(i),r=i+3;break;case"link":let d=prompt("Enter URL:");d&&(t=a.substring(0,l)+`[${n||"link"}](${d})`+a.substring(i),r=i+4*!n+d.length+3);return;default:return}o(e=>({...e,description:t})),setTimeout(()=>{N.current&&(N.current.focus(),N.current.setSelectionRange(r,r))},0)},U=async t=>{let r;if(t.preventDefault(),r={},n.title.trim()?n.title.length<3&&(r.title="Title must be at least 3 characters"):r.title="Title is required",n.description.trim()?n.description.length<50&&(r.description="Description must be at least 50 characters"):r.description="Description is required",n.imageUrl||(r.imageUrl="Please upload an image"),b(r),0===Object.keys(r).length){m(!0);try{let t,r=a?`/api/admin/blog/${e.id}`:"/api/admin/blog",l=await fetch(r,{method:a?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});try{t=await l.json()}catch(e){throw console.error("JSON parse error:",e),Error("Server returned invalid response. Please try again.")}if(!l.ok)throw Error(t.error||`Failed to ${a?"update":"save"} blog (Status: ${l.status})`);x(a?"Blog updated successfully!":"Blog created successfully!"),!a&&(o({title:"",description:"",imageUrl:""}),f(""),v.current&&(v.current.value="")),s&&setTimeout(()=>{s(t.data)},1e3),setTimeout(()=>{x("")},3e3)}catch(e){console.error("Save failed:",e),b(t=>({...t,form:e.message||`Failed to ${a?"update":"save"} blog. Please try again.`}))}finally{m(!1)}}},C=e=>{let{name:t,value:r}=e.target;o(e=>({...e,[t]:r})),g[t]&&b(e=>({...e,[t]:""}))};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:a?"Edit Blog Post":"Create New Blog Post"}),p&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-md",children:p}),g.form&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md",children:g.form}),(0,t.jsxs)("form",{onSubmit:U,className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Blog Title *"}),(0,t.jsx)("input",{type:"text",name:"title",value:n.title,onChange:C,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${g.title?"border-red-500":"border-gray-300"}`,placeholder:"Enter blog title"}),g.title&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:g.title})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Featured Image *"}),(0,t.jsxs)("div",{className:"space-y-3",children:[h||n.imageUrl?(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-full max-w-md border-2 border-dashed border-gray-300 rounded-lg overflow-hidden",children:(0,t.jsx)("img",{src:h||n.imageUrl,alt:"Preview",className:"w-full h-64 object-contain"})}),(0,t.jsx)("button",{type:"button",onClick:()=>{o(e=>({...e,imageUrl:""})),f(""),v.current&&(v.current.value=""),b(e=>({...e,imageUrl:""}))},className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full hover:bg-red-600",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}):(0,t.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[(0,t.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,t.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,t.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Upload a featured image"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 5MB"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block",children:[(0,t.jsx)("span",{className:"sr-only",children:"Choose image"}),(0,t.jsx)("input",{ref:v,type:"file",accept:"image/*",onChange:w,className:"block w-full text-sm text-gray-500   file:mr-4 file:py-2 file:px-4   file:rounded-md file:border-0   file:text-sm file:font-semibold   file:bg-blue-50 file:text-blue-700   hover:file:bg-blue-100   cursor-pointer"})]}),d&&(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,t.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full animate-pulse w-1/2"})}),(0,t.jsx)("p",{className:"mt-1 text-sm text-blue-600",children:"Uploading image..."})]}),g.imageUrl&&(0,t.jsx)("p",{className:"mt-2 text-sm text-red-600",children:g.imageUrl})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Blog Content *"}),(0,t.jsx)("button",{type:"button",onClick:()=>j(!y),className:"text-sm text-blue-600 hover:text-blue-800",children:y?"Show Editor":"Show Preview"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mb-2 p-2 bg-gray-50 rounded-md border border-gray-200",children:[(0,t.jsx)("button",{type:"button",onClick:()=>k("bold"),className:"px-3 py-1.5 text-sm font-bold bg-white border border-gray-300 rounded hover:bg-gray-50",title:"Bold (Ctrl+B)",children:(0,t.jsx)("strong",{children:"B"})}),(0,t.jsx)("button",{type:"button",onClick:()=>k("italic"),className:"px-3 py-1.5 text-sm italic bg-white border border-gray-300 rounded hover:bg-gray-50",title:"Italic (Ctrl+I)",children:(0,t.jsx)("em",{children:"I"})}),(0,t.jsxs)("button",{type:"button",onClick:()=>k("bullet"),className:"px-3 py-1.5 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50 flex items-center",title:"Bullet List",children:[(0,t.jsx)("span",{className:"mr-1",children:"â€¢"})," List"]}),(0,t.jsx)("button",{type:"button",onClick:()=>k("number"),className:"px-3 py-1.5 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50",title:"Numbered List",children:"1. List"}),(0,t.jsx)("button",{type:"button",onClick:()=>k("link"),className:"px-3 py-1.5 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50",title:"Insert Link",children:"ðŸ”— Link"}),(0,t.jsx)("div",{className:"text-xs text-gray-500 ml-auto flex items-center",children:(0,t.jsx)("span",{children:"Press Enter for new paragraph, Shift+Enter for line break"})})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mb-2 p-2 bg-blue-50 rounded",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Bold:"})," **text**"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("em",{children:"Italic:"})," *text*"]}),(0,t.jsx)("div",{children:"Bullet: â€¢ item"}),(0,t.jsx)("div",{children:"Numbered: 1. item"}),(0,t.jsx)("div",{children:"Link: [text](url)"}),(0,t.jsx)("div",{children:"Line break: Press Enter"})]})}),y?(0,t.jsx)("div",{className:`border rounded-md p-4 min-h-[200px] bg-gray-50 ${g.description?"border-red-500":"border-gray-300"}`,children:n.description?(0,t.jsx)("div",{className:"prose prose-lg max-w-none",children:(0,t.jsx)("div",{className:"text-gray-700 whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:(i=n.description.replace(/\n/g,"<br>").replace(/<br><br>/g,"</p><p>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/â€¢\s*(.*?)(?=<br>|$)/g,"<li>$1</li>").replace(/(\d+)\.\s*(.*?)(?=<br>|$)/g,"<li>$2</li>").replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2" class="text-blue-600 hover:underline">$1</a>'),`<p>${i}</p>`)}})}):(0,t.jsx)("p",{className:"text-gray-400 italic",children:"Preview will appear here..."})}):(0,t.jsx)("textarea",{ref:N,name:"description",value:n.description,onChange:C,rows:"15",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm ${g.description?"border-red-500":"border-gray-300"}`,placeholder:"Write your blog content here...      Use **bold** for important text   Use *italic* for emphasis   Use â€¢ for bullet points   Use 1. for numbered lists   Press Enter for new paragraphs      Example:   **Introduction**   This is a sample blog post.      â€¢ First point   â€¢ Second point   â€¢ Third point      1. Step one   2. Step two   3. Step three"}),g.description&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:g.description}),(0,t.jsxs)("div",{className:"mt-1 flex justify-between text-sm",children:[(0,t.jsx)("span",{className:`${n.description.length<50?"text-red-500":"text-gray-500"}`,children:"Minimum 50 characters required"}),(0,t.jsxs)("span",{className:`${n.description.length>=50?"text-green-500":"text-gray-500"}`,children:[n.description.length," characters"]})]})]}),(0,t.jsxs)("div",{className:"pt-4 flex justify-end space-x-3",children:[l&&(0,t.jsx)("button",{type:"button",onClick:l,disabled:d||u,className:"px-5 py-2.5 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:d||u,className:`px-5 py-2.5 rounded-md font-medium text-white flex items-center ${d||u?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}`,children:u?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a?"Updating...":"Publishing..."]}):d?"Uploading Image...":a?"Update Blog Post":"Publish Blog Post"})]})]})]})}e.s(["default",()=>s])}]);