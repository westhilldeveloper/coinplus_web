(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,50766,e=>{"use strict";var s=e.i(43476),t=e.i(71645);function a({gallery:e=null,onSuccess:a,onCancel:r}){let l=!!e,[i,n]=(0,t.useState)({title:e?.title||"",description:e?.description||"",images:e?.images||[]}),[o,d]=(0,t.useState)(!1),[c,m]=(0,t.useState)(!1),[u,x]=(0,t.useState)({}),[g,h]=(0,t.useState)(""),p=(0,t.useRef)(null),y=async e=>{let s=Array.from(e.target.files);if(!s.length)return;x(e=>({...e,images:""}));let t=[],a=[];if(s.forEach(e=>{e.type.startsWith("image/")?e.size>5242880?a.push(`${e.name}: Size exceeds 5MB`):t.push(e):a.push(`${e.name}: Not an image file`)}),a.length>0&&x(e=>({...e,images:`Some files were rejected:
${a.join("\n")}`})),0!==t.length){d(!0);try{console.log("Starting upload of",t.length,"images");let e=t.map(async e=>{let s=new FormData;s.append("file",e),s.append("upload_preset","tour_uploads");let t=await fetch("https://api.cloudinary.com/v1_1/ddsim4ixm/image/upload",{method:"POST",body:s});if(!t.ok){let s=await t.text();throw Error(`Failed to upload ${e.name}: ${s}`)}return(await t.json()).secure_url}),s=await Promise.all(e);n(e=>({...e,images:[...e.images,...s]})),h(`âœ“ ${s.length} image(s) uploaded successfully`),setTimeout(()=>h(""),3e3)}catch(e){console.error("Upload failed:",e),x(s=>({...s,images:e.message||"Image upload failed. Please try again."}))}finally{d(!1),p.current&&(p.current.value="")}}},b=async s=>{let t;if(s.preventDefault(),t={},i.title.trim()?i.title.length<3&&(t.title="Title must be at least 3 characters"):t.title="Title is required",i.description.trim()?i.description.length<10&&(t.description="Description must be at least 10 characters"):t.description="Description is required",0===i.images.length&&(t.images="At least one image is required"),x(t),0===Object.keys(t).length){m(!0);try{let s,t=l?`/api/admin/gallery/${e.id}`:"/api/admin/gallery",r=await fetch(t,{method:l?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});try{s=await r.json()}catch(e){throw console.error("JSON parse error:",e),Error("Server returned invalid response. Please try again.")}if(!r.ok)throw Error(s.error||`Failed to ${l?"update":"save"} gallery (Status: ${r.status})`);h(l?"Gallery updated successfully!":"Gallery created successfully!"),l||n({title:"",description:"",images:[]}),a&&setTimeout(()=>{a(s.data)},1e3),setTimeout(()=>{h("")},3e3)}catch(e){console.error("Save failed:",e),x(s=>({...s,form:e.message||`Failed to ${l?"update":"save"} gallery. Please try again.`}))}finally{m(!1)}}},f=e=>{let{name:s,value:t}=e.target;n(e=>({...e,[s]:t})),u[s]&&x(e=>({...e,[s]:""}))};return(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:l?"Edit Gallery":"Create New Gallery"}),g&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-md",children:g}),u.form&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md",children:u.form}),(0,s.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gallery Title *"}),(0,s.jsx)("input",{type:"text",name:"title",value:i.title,onChange:f,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${u.title?"border-red-500":"border-gray-300"}`,placeholder:"Enter gallery title"}),u.title&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:u.title})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,s.jsx)("textarea",{name:"description",value:i.description,onChange:f,rows:"4",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${u.description?"border-red-500":"border-gray-300"}`,placeholder:"Describe your gallery..."}),u.description&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:u.description}),(0,s.jsxs)("div",{className:"mt-1 text-sm text-gray-500",children:[i.description.length," characters (minimum 10)"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Images * (Multiple allowed)"}),(0,s.jsxs)("div",{className:"space-y-4",children:[i.images.length>0&&(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[i.images.length," image(s) uploaded"]}),i.images.length>0&&(0,s.jsx)("button",{type:"button",onClick:()=>n(e=>({...e,images:[]})),className:"text-sm text-red-600 hover:text-red-800",children:"Remove All"})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:i.images.map((e,t)=>(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsx)("div",{className:"aspect-square overflow-hidden rounded-lg border border-gray-200 bg-gray-100",children:(0,s.jsx)("img",{src:e,alt:`Gallery image ${t+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"})}),(0,s.jsx)("button",{type:"button",onClick:()=>{n(e=>({...e,images:e.images.filter((e,s)=>s!==t)}))},className:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200 hover:bg-red-600",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,s.jsxs)("div",{className:"text-xs text-center mt-1 text-gray-500 truncate",children:["Image ",t+1]})]},t))})]}),(0,s.jsxs)("div",{className:`border-2 border-dashed ${u.images?"border-red-300 bg-red-50":"border-gray-300"} rounded-lg p-6 text-center transition-colors duration-200`,children:[(0,s.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,s.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Drag and drop images here, or"}),(0,s.jsxs)("label",{className:"mt-2 inline-block",children:[(0,s.jsx)("span",{className:"sr-only",children:"Choose images"}),(0,s.jsx)("span",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 cursor-pointer font-medium text-sm",children:"Browse Files"}),(0,s.jsx)("input",{ref:p,type:"file",multiple:!0,accept:"image/*",onChange:y,className:"hidden"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"PNG, JPG, GIF up to 5MB each. You can select multiple files."})]}),o&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("div",{className:"w-full max-w-xs mx-auto bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-blue-600 h-2 rounded-full animate-pulse w-1/2"})}),(0,s.jsx)("p",{className:"mt-2 text-sm text-blue-600",children:"Uploading images..."})]})]}),u.images&&(0,s.jsx)("p",{className:"mt-2 text-sm text-red-600 whitespace-pre-line",children:u.images})]})]}),(0,s.jsxs)("div",{className:"pt-4 flex justify-end space-x-3",children:[r&&(0,s.jsx)("button",{type:"button",onClick:()=>{r&&r()},disabled:o||c,className:"px-5 py-2.5 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:o||c,className:`px-5 py-2.5 rounded-md font-medium text-white flex items-center ${o||c?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}`,children:c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l?"Updating...":"Creating..."]}):o?"Uploading Images...":l?"Update Gallery":"Create Gallery"})]})]})]})}e.s(["default",()=>a])},79337,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566),r=e.i(50766);function l(){let[e,l]=(0,t.useState)(null),[i,n]=(0,t.useState)(!0),[o,d]=(0,t.useState)(""),c=(0,a.useRouter)(),m=(0,a.useParams)();(0,t.useEffect)(()=>{u()},[m.id]);let u=async()=>{try{let e=await fetch(`/api/admin/gallery/${m.id}`),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to fetch gallery");l(s.data)}catch(e){console.error("Fetch error:",e),d(e.message)}finally{n(!1)}},x=()=>{c.push("/admin/media/gallery")};return i?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsx)("div",{className:"flex justify-center py-12",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600"})})})}):o?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-red-600 mb-2",children:"Error loading gallery"}),(0,s.jsx)("div",{className:"text-sm text-gray-600 mb-4",children:o}),(0,s.jsx)("button",{onClick:()=>c.push("/admin/media/gallery"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Back to Galleries"})]})})}):e?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("button",{onClick:x,className:"flex items-center text-gray-600 hover:text-gray-800",children:[(0,s.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Galleries"]})}),(0,s.jsx)(r.default,{gallery:e,onSuccess:()=>{c.push("/admin/media/gallery")},onCancel:x})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-gray-600",children:"Gallery not found"}),(0,s.jsx)("button",{onClick:()=>c.push("/admin/media/gallery"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Back to Galleries"})]})})})}e.s(["default",()=>l])}]);