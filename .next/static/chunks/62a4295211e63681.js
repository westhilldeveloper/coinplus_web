(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,50766,e=>{"use strict";var t=e.i(43476),s=e.i(71645);function a({gallery:e=null,onSuccess:a,onCancel:r}){let l=!!e,[i,o]=(0,s.useState)({title:e?.title||"",description:e?.description||"",images:e?.images||[]}),[n,d]=(0,s.useState)(!1),[c,m]=(0,s.useState)(!1),[u,g]=(0,s.useState)({}),[x,h]=(0,s.useState)(""),p=(0,s.useRef)(null),y=async e=>{let t=Array.from(e.target.files);if(!t.length)return;g(e=>({...e,images:""}));let s=[],a=[];if(t.forEach(e=>{e.type.startsWith("image/")?e.size>5242880?a.push(`${e.name}: Size exceeds 5MB`):s.push(e):a.push(`${e.name}: Not an image file`)}),a.length>0&&g(e=>({...e,images:`Some files were rejected:
${a.join("\n")}`})),0!==s.length){d(!0);try{console.log("Starting upload of",s.length,"images");let e=s.map(async e=>{let t=new FormData;t.append("file",e),t.append("upload_preset","tour_uploads");let s=await fetch("https://api.cloudinary.com/v1_1/ddsim4ixm/image/upload",{method:"POST",body:t});if(!s.ok){let t=await s.text();throw Error(`Failed to upload ${e.name}: ${t}`)}return(await s.json()).secure_url}),t=await Promise.all(e);o(e=>({...e,images:[...e.images,...t]})),h(`âœ“ ${t.length} image(s) uploaded successfully`),setTimeout(()=>h(""),3e3)}catch(e){console.error("Upload failed:",e),g(t=>({...t,images:e.message||"Image upload failed. Please try again."}))}finally{d(!1),p.current&&(p.current.value="")}}},b=async t=>{let s;if(t.preventDefault(),s={},i.title.trim()?i.title.length<3&&(s.title="Title must be at least 3 characters"):s.title="Title is required",i.description.trim()?i.description.length<10&&(s.description="Description must be at least 10 characters"):s.description="Description is required",0===i.images.length&&(s.images="At least one image is required"),g(s),0===Object.keys(s).length){m(!0);try{let t,s=l?`/api/admin/gallery/${e.id}`:"/api/admin/gallery",r=await fetch(s,{method:l?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});try{t=await r.json()}catch(e){throw console.error("JSON parse error:",e),Error("Server returned invalid response. Please try again.")}if(!r.ok)throw Error(t.error||`Failed to ${l?"update":"save"} gallery (Status: ${r.status})`);h(l?"Gallery updated successfully!":"Gallery created successfully!"),l||o({title:"",description:"",images:[]}),a&&setTimeout(()=>{a(t.data)},1e3),setTimeout(()=>{h("")},3e3)}catch(e){console.error("Save failed:",e),g(t=>({...t,form:e.message||`Failed to ${l?"update":"save"} gallery. Please try again.`}))}finally{m(!1)}}},f=e=>{let{name:t,value:s}=e.target;o(e=>({...e,[t]:s})),u[t]&&g(e=>({...e,[t]:""}))};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:l?"Edit Gallery":"Create New Gallery"}),x&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-md",children:x}),u.form&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md",children:u.form}),(0,t.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gallery Title *"}),(0,t.jsx)("input",{type:"text",name:"title",value:i.title,onChange:f,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${u.title?"border-red-500":"border-gray-300"}`,placeholder:"Enter gallery title"}),u.title&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:u.title})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,t.jsx)("textarea",{name:"description",value:i.description,onChange:f,rows:"4",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${u.description?"border-red-500":"border-gray-300"}`,placeholder:"Describe your gallery..."}),u.description&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:u.description}),(0,t.jsxs)("div",{className:"mt-1 text-sm text-gray-500",children:[i.description.length," characters (minimum 10)"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Images * (Multiple allowed)"}),(0,t.jsxs)("div",{className:"space-y-4",children:[i.images.length>0&&(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[i.images.length," image(s) uploaded"]}),i.images.length>0&&(0,t.jsx)("button",{type:"button",onClick:()=>o(e=>({...e,images:[]})),className:"text-sm text-red-600 hover:text-red-800",children:"Remove All"})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:i.images.map((e,s)=>(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)("div",{className:"aspect-square overflow-hidden rounded-lg border border-gray-200 bg-gray-100",children:(0,t.jsx)("img",{src:e,alt:`Gallery image ${s+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"})}),(0,t.jsx)("button",{type:"button",onClick:()=>{o(e=>({...e,images:e.images.filter((e,t)=>t!==s)}))},className:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200 hover:bg-red-600",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,t.jsxs)("div",{className:"text-xs text-center mt-1 text-gray-500 truncate",children:["Image ",s+1]})]},s))})]}),(0,t.jsxs)("div",{className:`border-2 border-dashed ${u.images?"border-red-300 bg-red-50":"border-gray-300"} rounded-lg p-6 text-center transition-colors duration-200`,children:[(0,t.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,t.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Drag and drop images here, or"}),(0,t.jsxs)("label",{className:"mt-2 inline-block",children:[(0,t.jsx)("span",{className:"sr-only",children:"Choose images"}),(0,t.jsx)("span",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 cursor-pointer font-medium text-sm",children:"Browse Files"}),(0,t.jsx)("input",{ref:p,type:"file",multiple:!0,accept:"image/*",onChange:y,className:"hidden"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"PNG, JPG, GIF up to 5MB each. You can select multiple files."})]}),n&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("div",{className:"w-full max-w-xs mx-auto bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-blue-600 h-2 rounded-full animate-pulse w-1/2"})}),(0,t.jsx)("p",{className:"mt-2 text-sm text-blue-600",children:"Uploading images..."})]})]}),u.images&&(0,t.jsx)("p",{className:"mt-2 text-sm text-red-600 whitespace-pre-line",children:u.images})]})]}),(0,t.jsxs)("div",{className:"pt-4 flex justify-end space-x-3",children:[r&&(0,t.jsx)("button",{type:"button",onClick:()=>{r&&r()},disabled:n||c,className:"px-5 py-2.5 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:n||c,className:`px-5 py-2.5 rounded-md font-medium text-white flex items-center ${n||c?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}`,children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l?"Updating...":"Creating..."]}):n?"Uploading Images...":l?"Update Gallery":"Create Gallery"})]})]})]})}e.s(["default",()=>a])},1916,e=>{"use strict";var t=e.i(43476),s=e.i(50766),a=e.i(18566);function r(){let e=(0,a.useRouter)(),r=()=>{e.push("/admin/media/gallery")};return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)("button",{onClick:r,className:"flex items-center text-gray-600 hover:text-gray-800",children:[(0,t.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Galleries"]})}),(0,t.jsx)(s.default,{onSuccess:()=>{e.push("/admin/media/gallery")},onCancel:r})]})})}e.s(["default",()=>r])}]);