(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75e3,e=>{"use strict";var r=e.i(43476),s=e.i(71645);function t(){let[e,t]=(0,s.useState)({description:"",imageUrl:""}),[a,l]=(0,s.useState)(!1),[i,o]=(0,s.useState)(!1),[n,d]=(0,s.useState)({}),[c,m]=(0,s.useState)(""),[u,h]=(0,s.useState)(""),g=(0,s.useRef)(null),x=async r=>{let s=r.target.files[0];if(!s)return;if(d(e=>({...e,imageUrl:""})),!s.type.startsWith("image/"))return void d(e=>({...e,imageUrl:"Please select an image file (JPEG, PNG, GIF, etc.)"}));if(s.size>5242880)return void d(e=>({...e,imageUrl:"Image size should be less than 5MB"}));h(URL.createObjectURL(s)),l(!0);let a=new FormData;a.append("file",s),a.append("upload_preset","tour_uploads");try{let r=await fetch("https://api.cloudinary.com/v1_1/ddsim4ixm/image/upload",{method:"POST",body:a});if(!r.ok)throw Error(`Upload failed with status: ${r.status}`);let s=await r.json();if(!s.secure_url)throw Error("No secure URL returned from Cloudinary");t({...e,imageUrl:s.secure_url}),m("âœ“ Image uploaded successfully"),setTimeout(()=>m(""),2e3)}catch(e){console.error("Upload failed:",e),d(r=>({...r,imageUrl:e.message||"Image upload failed. Please try again."})),h(""),t(e=>({...e,imageUrl:""}))}finally{l(!1)}},p=async r=>{let s;if(r.preventDefault(),s={},e.description.trim()?e.description.length<10&&(s.description="Description must be at least 10 characters"):s.description="Description is required",e.imageUrl||(s.imageUrl="Please upload an image"),d(s),0===Object.keys(s).length){o(!0);try{let r,s=await fetch("/api/admin/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});try{r=await s.json()}catch(e){throw console.error("JSON parse error:",e),Error("Server returned invalid response. Please try again.")}if(!s.ok)throw Error(r.error||`Failed to save events (Status: ${s.status})`);m("events saved successfully!"),t({description:"",imageUrl:""}),h(""),g.current&&(g.current.value=""),setTimeout(()=>{m("")},3e3)}catch(e){console.error("Save failed:",e),d(r=>({...r,form:e.message||"Failed to save events. Please try again."}))}finally{o(!1)}}};return(0,r.jsxs)("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Add events"}),c&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-md",children:c}),n.form&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md",children:n.form}),(0,r.jsxs)("form",{onSubmit:p,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image *"}),(0,r.jsxs)("div",{className:"space-y-3",children:[u||e.imageUrl?(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-full max-w-md border-2 border-dashed border-gray-300 rounded-lg overflow-hidden",children:(0,r.jsx)("img",{src:u||e.imageUrl,alt:"Preview",className:"w-full h-64 object-contain"})}),(0,r.jsx)("button",{type:"button",onClick:()=>{t(e=>({...e,imageUrl:""})),h(""),g.current&&(g.current.value=""),d(e=>({...e,imageUrl:""}))},className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full hover:bg-red-600",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}):(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,r.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Upload an image"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 5MB"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"sr-only",children:"Choose image"}),(0,r.jsx)("input",{ref:g,type:"file",accept:"image/*",onChange:x,className:"block w-full text-sm text-gray-500   file:mr-4 file:py-2 file:px-4   file:rounded-md file:border-0   file:text-sm file:font-semibold   file:bg-blue-50 file:text-blue-700   hover:file:bg-blue-100   cursor-pointer"})]}),a&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full animate-pulse w-1/2"})}),(0,r.jsx)("p",{className:"mt-1 text-sm text-blue-600",children:"Uploading image..."})]}),n.imageUrl&&(0,r.jsx)("p",{className:"mt-2 text-sm text-red-600",children:n.imageUrl})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,r.jsx)("textarea",{name:"description",value:e.description,onChange:e=>{let{name:r,value:s}=e.target;t(e=>({...e,[r]:s})),n[r]&&d(e=>({...e,[r]:""}))},rows:"6",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.description?"border-red-500":"border-gray-300"}`,placeholder:"Write your events description here..."}),n.description&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:n.description}),(0,r.jsxs)("div",{className:"mt-1 flex justify-between text-sm",children:[(0,r.jsx)("span",{className:`${e.description.length<10?"text-red-500":"text-gray-500"}`,children:"Minimum 10 characters required"}),(0,r.jsxs)("span",{className:`${e.description.length>=10?"text-green-500":"text-gray-500"}`,children:[e.description.length,"/10"]})]})]}),(0,r.jsx)("div",{className:"pt-4",children:(0,r.jsx)("button",{type:"submit",disabled:a||i,className:`w-full py-3 px-4 rounded-md font-medium text-white flex items-center justify-center ${a||i?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}`,children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):a?"Uploading Image...":"Save events"})})]})]})}e.s(["default",()=>t])}]);